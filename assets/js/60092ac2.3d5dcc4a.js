"use strict";(self.webpackChunkrichie_education_docs=self.webpackChunkrichie_education_docs||[]).push([[35987],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var i=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=i.createContext({}),l=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=l(e.components);return i.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=l(t),f=o,m=d["".concat(s,".").concat(f)]||d[f]||u[f]||r;return t?i.createElement(m,a(a({ref:n},p),{},{components:t})):i.createElement(m,a({ref:n},p))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,a=new Array(r);a[0]=d;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var l=2;l<r;l++)a[l]=t[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},83328:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>s,default:()=>f,frontMatter:()=>c,metadata:()=>l,toc:()=>u});var i=t(83117),o=t(80102),r=(t(67294),t(3905)),a=["components"],c={id:"joanie-connection",title:"Joanie Connection",sidebar_label:"Joanie Connection"},s="Joanie Connection",l={unversionedId:"joanie-connection",id:"version-2.18.0/joanie-connection",title:"Joanie Connection",description:"Settings",source:"@site/versioned_docs/version-2.18.0/joanie-connection.md",sourceDirName:".",slug:"/joanie-connection",permalink:"/docs/joanie-connection",draft:!1,tags:[],version:"2.18.0",lastUpdatedBy:"jbpenrath",lastUpdatedAt:1673544673,formattedLastUpdatedAt:"Jan 12, 2023",frontMatter:{id:"joanie-connection",title:"Joanie Connection",sidebar_label:"Joanie Connection"}},p={},u=[{value:"Settings",id:"settings",level:2},{value:"Access Token",id:"access-token",level:2},{value:"Lifetime configuration",id:"lifetime-configuration",level:3}],d={toc:u};function f(e){var n=e.components,t=(0,o.Z)(e,a);return(0,r.kt)("wrapper",(0,i.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"joanie-connection"},"Joanie Connection"),(0,r.kt)("h2",{id:"settings"},"Settings"),(0,r.kt)("p",null,"All settings related to Joanie have to be declared in the ",(0,r.kt)("inlineCode",{parentName:"p"},"JOANIE_BACKEND")," dictionary\nwithin ",(0,r.kt)("inlineCode",{parentName:"p"},"settings.py"),".\nTo enable Joanie, the minimal configuration requires following properties:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"BASE_URL")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"BACKEND")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"COURSE_REGEX")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"JS_COURSE_REGEX"))),(0,r.kt)("p",null,"Take a look to ",(0,r.kt)("a",{parentName:"p",href:"/docs/lms-backends#configuring-the-lms-handler"},"LMS Backend documentation")," to get details about those properties."),(0,r.kt)("p",null,"Add to your ",(0,r.kt)("inlineCode",{parentName:"p"},"settings.py"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'...\nJOANIE_BACKEND = {\n    "BASE_URL": values.Value(environ_name="JOANIE_BASE_URL", environ_prefix=None),\n    "BACKEND": values.Value("richie.apps.courses.lms.joanie.JoanieBackend", environ_name="JOANIE_BACKEND", environ_prefix=None),\n    "JS_BACKEND": values.Value("joanie", environ_name="JOANIE_JS_BACKEND", environ_prefix=None),\n    "COURSE_REGEX": values.Value(\n        r"^.*/api/(?P<resource_type>(course-runs|products))/(?P<resource_id>.*)/?$",\n        environ_name="JOANIE_COURSE_REGEX",\n        environ_prefix=None,\n    ),\n    "JS_COURSE_REGEX": values.Value(\n        r"^.*/api/(course-runs|products)/(.*)/?$",\n        environ_name="JOANIE_JS_COURSE_REGEX",\n        environ_prefix=None,\n    ),\n}\n...\n')),(0,r.kt)("h2",{id:"access-token"},"Access Token"),(0,r.kt)("h3",{id:"lifetime-configuration"},"Lifetime configuration"),(0,r.kt)("p",null,"Access Token is stored within the SessionStorage through ",(0,r.kt)("a",{parentName:"p",href:"https://tanstack.com/query/v4/docs/plugins/persistQueryClient"},"react-query client persister"),".\nBy default, richie frontend considered access token as stale after 5 minutes. You can change this\nvalue into ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openfun/richie/blob/643d7bbdb7f9a02a86360607a7b37c587e70be1a/src/frontend/js/settings.ts"},(0,r.kt)("inlineCode",{parentName:"a"},"settings.ts")),"\nby editing ",(0,r.kt)("inlineCode",{parentName:"p"},"REACT_QUERY_SETTINGS.staleTimes.session"),"."),(0,r.kt)("p",null,"To always have a valid access token, you have to configure properly its stale time according to the\nlifetime of the access token defined by your authentication server. For example, if your\nauthentication server is using ",(0,r.kt)("inlineCode",{parentName:"p"},"djangorestframework-simplejwt")," to generate the access token,\nits lifetime is 5 minutes by default."))}f.isMDXComponent=!0}}]);